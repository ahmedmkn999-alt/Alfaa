<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…ÙˆØ§Ø¯ | ALPHA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="auth.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@700&family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { 
            background-color: #000; 
            color: white; font-family: 'Tajawal', sans-serif; 
            min-height: 100vh; padding-bottom: 80px;
            overflow-x: hidden;
        }

        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„ÙØ¶Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© */
        .bg-space {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;
            background: radial-gradient(circle at 50% 0%, #2e1065, #000 70%);
        }
        .orb {
            position: absolute; width: 300px; height: 300px;
            background: #6366f1; filter: blur(100px); opacity: 0.2;
            animation: moveOrb 10s infinite alternate;
        }
        @keyframes moveOrb { from { transform: translate(-20%, -20%); } to { transform: translate(20%, 20%); } }

        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ */
        .header {
            background: rgba(255,255,255,0.03); backdrop-filter: blur(20px);
            padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05);
            display: flex; justify-content: space-between; align-items: center;
            border-radius: 0 0 30px 30px; margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }

        /* ÙƒØ±ÙˆØª Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ (Neon Glass) */
        .subject-card {
            background: rgba(30, 41, 59, 0.3); 
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px; padding: 20px;
            position: relative; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            text-align: center; height: 180px;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬ Ø¹Ù†Ø¯ Ø§Ù„Ù„Ù…Ø³ */
        .subject-card::before {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(45deg, transparent, rgba(99, 102, 241, 0.1), transparent);
            opacity: 0; transition: 0.3s;
        }
        .subject-card:hover {
            transform: translateY(-5px);
            border-color: #8b5cf6;
            box-shadow: 0 10px 30px -10px rgba(139, 92, 246, 0.3);
        }
        .subject-card:hover::before { opacity: 1; }

        /* Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„Ù€ 3D */
        .s-icon {
            width: 70px; height: 70px; margin-bottom: 15px;
            filter: drop-shadow(0 5px 15px rgba(0,0,0,0.5));
            transition: 0.3s;
        }
        .subject-card:hover .s-icon { transform: scale(1.1) rotate(5deg); }

        .s-title { font-size: 1.2rem; font-weight: 800; margin-bottom: 5px; color: white; }
        .s-info { font-size: 0.8rem; color: #94a3b8; background: rgba(0,0,0,0.3); padding: 4px 12px; border-radius: 20px; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ù…Ø³ØªÙˆÙ‰ */
        .level-bar {
            width: 100%; height: 6px; background: rgba(255,255,255,0.1);
            border-radius: 10px; margin-top: 10px; overflow: hidden;
        }
        .level-fill {
            height: 100%; background: linear-gradient(90deg, #6366f1, #d946ef);
            width: 75%; border-radius: 10px;
        }
    </style>
</head>
<body>

    <div class="bg-space"><div class="orb"></div></div>

    <div id="app">
        <header class="header">
            <a href="timer.html" class="flex items-center gap-4 group">
                <div class="relative">
                    <img src="https://cdn-icons-png.flaticon.com/512/4140/4140048.png" class="w-14 h-14 rounded-full border-2 border-indigo-500 bg-indigo-900/20 p-1">
                    <div class="absolute bottom-0 right-0 w-4 h-4 bg-green-500 border-2 border-black rounded-full"></div>
                </div>
                <div>
                    <h2 class="font-bold text-lg leading-tight group-hover:text-indigo-400 transition" id="sName">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>
                    <p class="text-xs text-gray-400 mb-1">Level 1 Student</p>
                    <div class="level-bar w-24"><div class="level-fill"></div></div>
                </div>
            </a>
            <button onclick="logout()" class="w-10 h-10 rounded-full bg-white/5 hover:bg-red-500/20 text-gray-400 hover:text-red-500 transition flex items-center justify-center">
                <i class="fas fa-power-off"></i>
            </button>
        </header>

        <div class="px-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-white to-gray-400">Ù…ÙƒØªØ¨ØªÙƒ</h3>
                <span class="text-xs bg-indigo-500/20 text-indigo-300 px-3 py-1 rounded-full border border-indigo-500/30">
                    {{ subjects.length }} Ù…ÙˆØ§Ø¯
                </span>
            </div>

            <div v-if="loading" class="grid grid-cols-2 gap-4">
                <div class="subject-card animate-pulse"><div class="w-12 h-12 bg-gray-700 rounded-full mb-3"></div><div class="h-4 w-20 bg-gray-700 rounded"></div></div>
                <div class="subject-card animate-pulse"><div class="w-12 h-12 bg-gray-700 rounded-full mb-3"></div><div class="h-4 w-20 bg-gray-700 rounded"></div></div>
            </div>
            
            <div v-else class="grid grid-cols-2 gap-4">
                <div v-for="s in subjects" :key="s.id" @click="go(s)" class="subject-card cursor-pointer">
                    <img :src="getImg(s.name)" class="s-icon">
                    <h3 class="s-title">{{ s.name }}</h3>
                    <span class="s-info">{{ s.teachers?.length || 0 }} Ù…Ø¯Ø±Ø³ÙŠÙ†</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        // ğŸŒŸ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª 3D Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©
        const IMGS = {
            "Ø¹Ø±Ø¨": "https://cdn-icons-png.flaticon.com/512/330/330459.png", // Ø¹Ù„Ù…
            "Ù„ØºØ© Ø¹Ø±Ø¨ÙŠØ©": "https://cdn-icons-png.flaticon.com/512/10605/10605973.png", // ÙƒØªØ§Ø¨ Ø¹Ø±Ø¨ÙŠ
            "Ù†Ø¬Ù„ÙŠØ²": "https://cdn-icons-png.flaticon.com/512/3269/3269817.png", // Ø¹Ù„Ù… Ø£Ù…Ø±ÙŠÙƒØ§ 3D
            "English": "https://cdn-icons-png.flaticon.com/512/3269/3269817.png",
            "ÙØ±Ù†Ø³": "https://cdn-icons-png.flaticon.com/512/330/330490.png", // Ø¹Ù„Ù… ÙØ±Ù†Ø³Ø§
            "ÙÙŠØ²ÙŠØ§": "https://cdn-icons-png.flaticon.com/512/3081/3081530.png", // Ø°Ø±Ø© Ø²Ø±Ù‚Ø§Ø¡
            "ÙƒÙŠÙ…ÙŠØ§": "https://cdn-icons-png.flaticon.com/512/4341/4341112.png", // Ù‚Ø§Ø±ÙˆØ±Ø© ØªØ¬Ø±Ø¨Ø©
            "Ø£Ø­ÙŠØ§": "https://cdn-icons-png.flaticon.com/512/2997/2997300.png", // DNA
            "Ø¨ÙŠÙˆÙ„ÙˆØ¬": "https://cdn-icons-png.flaticon.com/512/2997/2997300.png",
            "Ø±ÙŠØ§Ø¶": "https://cdn-icons-png.flaticon.com/512/4151/4151897.png", // Ø­Ø§Ø³Ø¨Ø© ÙˆØ£Ø±Ù‚Ø§Ù…
            "Ø¬Ø¨Ø±": "https://cdn-icons-png.flaticon.com/512/4151/4151897.png",
            "ØªØ§Ø±ÙŠØ®": "https://cdn-icons-png.flaticon.com/512/2234/2234665.png", // Ù…Ø®Ø·ÙˆØ·Ø©
            "Ø¬ØºØ±Ø§ÙÙŠ": "https://cdn-icons-png.flaticon.com/512/854/854878.png", // Ø®Ø±ÙŠØ·Ø© 3D
            "ÙÙ„Ø³Ù": "https://cdn-icons-png.flaticon.com/512/3169/3169230.png", // Ø¹Ù‚Ù„
            "Ù†ÙØ³": "https://cdn-icons-png.flaticon.com/512/3169/3169230.png",
            "default": "https://cdn-icons-png.flaticon.com/512/3209/3209990.png" // ÙƒØªØ§Ø¨ Ù…ÙØªÙˆØ­
        };

        const URLS = {
            'Ø¹Ù„Ù…ÙŠ Ø¹Ù„ÙˆÙ…': "https://plus-teal.vercel.app/organized_output.json",
            'Ø£Ø¯Ø¨ÙŠ': "https://plus-teal.vercel.app/organized_output-a.json", 
            'Ø¹Ù„Ù…ÙŠ Ø±ÙŠØ§Ø¶Ø©': "https://platform-sigma-seven.vercel.app/organized_output-e.json",
            'Ø£Ø²Ù‡Ø±': "https://plus-teal.vercel.app/organized_output.json"
        };

        createApp({
            setup() {
                const subjects = ref([]);
                const loading = ref(true);
                const yid = ref(null);
                
                // Ø¯Ø§Ù„Ø© Ø°ÙƒÙŠØ© Ù„Ù„ØµÙˆØ±
                const getImg = (n) => {
                    for(let k in IMGS) if(n.includes(k)) return IMGS[k];
                    return IMGS['default'];
                };

                const go = (s) => window.location.href = `chapters.html?yid=${yid.value}&sid=${s.id}`;

                onMounted(async () => {
                    const code = checkAuth(); // Ù…Ù† Ù…Ù„Ù auth.js
                    const db = firebase.database();
                    
                    try {
                        const snap = await db.ref('approvedStudents/'+code).once('value');
                        const user = snap.val();
                        document.getElementById('sName').innerText = user.studentName;

                        const res = await fetch(URLS[user.section] || URLS['Ø¹Ù„Ù…ÙŠ Ø¹Ù„ÙˆÙ…']);
                        const data = await res.json();
                        let year = data.find(y => y.id == 3) || data[0];
                        yid.value = year.id;
                        subjects.value = year.subjects || [];
                    } catch(e) { console.error(e); } 
                    finally { loading.value = false; }
                });
                return { subjects, loading, getImg, go };
            }
        }).mount('#app');
    </script>
</body>
                </html>
    
